summary: Collection of Linux utilities
git-url: https://github.com/karelzak/util-linux.git
src-url: https://mirrors.edge.kernel.org/pub/linux/utils/util-linux/v2.38/util-linux-2.38.1.tar.xz
src-sha: 60492a19b44e6cf9a3ddff68325b333b8b52b6c59ce3ebd6a0ecaa4c5117e84f
license: GPL-2.0-or-later
dep-pkg: readline automake libtool

# Fix lib/procfs.c:9:10: fatal error: 'sys/vfs.h' file not found
fix-url: https://github.com/util-linux/util-linux/commit/3671d4a878fb58aa953810ecf9af41809317294f.patch?full_index=1
fix-sha: d38c9ae06c387da151492dd5862c58551559dd6d2b1877c74cc1e11754221fe4

prepare: |
    if [ "$NATIVE_OS_KIND" = darwin ] ; then
        patch -p1 < ../fix/3671d4a878fb58aa953810ecf9af41809317294f.patch
    fi

install: |
    export AUTOMAKE="$(command -v automake)"
    export ACLOCAL="$(command -v aclocal)"

    unset EXTRA_CONFIGURE_ARGS

    case $NATIVE_OS_KIND in
        darwin) EXTRA_CONFIGURE_ARGS='--disable-libmount --disable-ipcrm --disable-ipcs --disable-wall' ;;
    esac

    configure \
        --without-python \
        --without-systemd \
        --enable-widechar \
        --enable-libuuid \
        --disable-use-tty-group \
        --disable-chfn-chsh \
        --disable-login \
        --disable-su \
        --disable-runuser \
        --disable-makeinstall-chown \
        --disable-makeinstall-setuid \
        $EXTRA_CONFIGURE_ARGS
