summary: Lightweight PDF and XPS viewer
git-url: https://git.ghostscript.com/mupdf
web-url: https://mupdf.com/
src-url: https://mupdf.com/downloads/archive/mupdf-1.22.1-source.tar.lz
src-sha: 33b00317b93bc404cffb67c91a5e6bb1b62051536829171c5f75cbaf2c1ea7df
license: AGPL-3.0-or-later
dep-pkg: openjpeg openssl mujs libjpeg-turbo jbig2dec freetype2-with-harfbuzz gumbo-parser freeglut mesa xorg-libxext
binbstd: yes
dopatch: |
    for item in $(find thirdparty -maxdepth 1 -mindepth 1 -type d)
    do
        [ "$item" = thirdparty/extract ] && continue
        [ "$item" = thirdparty/lcms2 ]   && continue
        run rm -rf "$item"
    done

install: |
    gmakew clean &&
    gmakew install \
        build=release \
        shared=yes \
        verbose=yes \
        prefix=$PACKAGE_INSTALL_DIR \
        CC=$CC \
        AR=$AR \
        RANLIB=$RANLIB \
        XCFLAGS="'$CFLAGS $CPPFLAGS'" \
        USE_SYSTEM_LIBS=yes \
        USE_SYSTEM_MUJS=yes
