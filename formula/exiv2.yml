summary: A command-line utility to read, write, delete and modify Exif, IPTC, XMP and ICC image metadata
web-url: https://exiv2.org/
git-url: https://github.com/Exiv2/exiv2
src-url: https://github.com/Exiv2/exiv2/archive/refs/tags/v0.28.3.tar.gz
src-sha: 1315e17d454bf4da3cc0edb857b1d2c143670f3485b537d0f946d9ed31d87b70
license: GPL-2.0-or-later
dep-pkg: libexpat libcurl libssh inih

dopatch: |
    CURL_LIBRARIES="$(pkg-config --libs-only-l libcurl)"

    if [ "$TARGET_PLATFORM_NAME" = macos ] ; then
        sedInPlace "s|\${CURL_LIBRARIES}|$CURL_LIBRARIES \"-framework CoreFoundation\" \"-framework SystemConfiguration\"|" src/CMakeLists.txt
    else
        sedInPlace "s|\${CURL_LIBRARIES}|$CURL_LIBRARIES|" src/CMakeLists.txt
    fi

install: |
    cmakew \
        -DEXIV2_ENABLE_NLS=OFF \
        -DEXIV2_ENABLE_XMP=ON \
        -DEXIV2_ENABLE_PNG=ON \
        -DEXIV2_ENABLE_SSH=ON \
        -DEXIV2_ENABLE_CURL=ON \
        -DEXIV2_ENABLE_BMFF=ON \
        -DEXIV2_ENABLE_VIDEO=ON \
        -DEXIV2_ENABLE_LENSDATA=ON \
        -DEXIV2_ENABLE_WEBREADY=ON \
        -DEXIV2_ENABLE_PRINTUCS2=ON \
        -DEXIV2_BUILD_EXIV2_COMMAND=ON \
        -DEXIV2_BUILD_SAMPLES=OFF \
        -DBUILD_SHARED_LIBS=OFF
