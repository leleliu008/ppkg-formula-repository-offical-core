summary: utilities and libraries to read, create and modify ELF binary files
git-url: git://sourceware.org/git/elfutils.git
web-url: https://sourceware.org/elfutils
src-url: https://sourceware.org/elfutils/ftp/0.190/elfutils-0.190.tar.bz2
src-sha: 8e00a3a9b5f04bc1dc273ae86281d2d26ed412020b391ffcc23198f10231d692
license: GPL-2.0-or-later GPL-3.0-or-later LGPL-2.0-only
dep-pkg: gettext libzstd liblzma libbz2 zlib argp-standalone musl-obstack musl-fts
dep-upp: gm4
ccflags: -Wno-error
sfslink: no
dopatch: |
    sed_in_place 's|-Wl,--no-whole-archive|-lintl -liconv -Wl,--no-whole-archive|' libasm/Makefile.in
    sed_in_place 's|-Wl,--no-whole-archive|-lintl -liconv -Wl,--no-whole-archive|' libelf/Makefile.in
    sed_in_place 's|-Wl,--no-whole-archive|-lintl -liconv -Wl,--no-whole-archive|' libdw/Makefile.in
install: |
    # FNM_EXTMATCH is a GNU externsion, musl does not define it
    if [ "$NATIVE_OS_LIBC" = musl ] ; then
        export CPPFLAGS="$CPPFLAGS -DFNM_EXTMATCH=0"
    fi

    export LIBS="$(pkg-config --libs libintl)"

    configure \
        --program-prefix=elfutils- \
        --disable-libdebuginfod \
        --disable-debuginfod \
        --enable-install-elfh \
        --with-zstd \
        --with-lzma \
        --with-zlib \
        --with-bzlib
